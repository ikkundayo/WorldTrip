<div class="memory-show-title-box">
  <%= link_to reviews_path("type": "link") do %>
    <i class="fa-solid fa-angle-left memory-show-left"></i>
  <% end %>
  <span class="review-show-title"><„É¨„Éì„É•„ÉºË©≥Á¥∞></span>
</div>

<div class='container'>
  <div class='row justify-content-center'>
    <div class='col-md-3 mt-3'>
      <div class='row justify-content-center'>
        <div class='col-md-10 text-center '>
          <table class='table'>
            <tr>
              <td>
                <i class="flag-icon flag-icon-<%= @country.code.downcase %> show-ranking-icon"></i><br>
                <span class="ranking-show-country-name"><%= @country.name_jp %></span>
                <% if user_signed_in? %>
                  <% if @experience.exists?(country_code: @country.name_jp)%>
          	        <i class="fas fa-shoe-prints"></i><br>
          	      <% else %>
          	        <i class="show_like">
                      <%= render "public/review_likes/like_show", review: @country, like: @like %>
                    </i>
                  <% end %>
                <% end %>
                <br>
              </td>
            </tr>
            <% if @reviews.blank? %>
              <tr>
                <td>„Åæ„Å†„É¨„Éì„É•„Éº„Åå„ÅÇ„Çä„Åæ„Åõ„Çìüò≠</td>
              </tr>
              </table></div></div></div></div></div>
            <% else %>
              <tr>
                <th class="total-content">Á∑èÂêàË©ï‰æ° <%= @reviews.average(:review_average).round(1) %><br>
                <div id="average-rate"></div>
                </th>
              </tr>
              <tr>
                <td class="onother-content">Ê•Ω„Åó„Åï„ÉªÂ®ØÊ•Ω <%= @reviews.average(:amusement_rate).round(1) %><br>
                  <span id="amusement-rate"></span>
                  (<%= @reviews.count(:amusement_rate) %>)
                </td>
              </tr>
              <tr>
                <td class="onother-content">„Ç∞„É´„É° <%= @reviews.average(:gourmet_rate).round(1) %><br>
                  <span id="gourmet-rate"></span>
                  (<%= @reviews.count(:gourmet_rate) %>)
                </td>
              </tr>
              <tr>
                <td class="onother-content">Ê≤ªÂÆâ <%= @reviews.average(:security_rate).round(1) %><br>
                  <span id="security-rate"></span>
                  (<%= @reviews.count(:security_rate) %>)
                </td>
              </tr>
              <tr>
                <td class="onother-content">„Åä„Åô„Åô„ÇÅÂ∫¶ <%= @reviews.average(:recommend_rate).round(1) %><br>
                  <span id="recommend-rate"></span>
                  (<%= @reviews.count(:recommend_rate) %>)
                </td>
              </tr>

              <% if @reviews.average(:original_rate).nil? %>
                <tr>
                  <td class="onother-content">„Ç™„É™„Ç∏„Éä„É´„Ç´„ÉÜ„Ç¥„É™„Éº <br>
                    <span id="original-rate0"></span>
                    (<%= @reviews.count(:original_rate) %>)
                  </td>
                </tr>
              <% else %>
                <tr>
                  <td class="onother-content">„Ç™„É™„Ç∏„Éä„É´„Ç´„ÉÜ„Ç¥„É™„Éº <%= @reviews.average(:original_rate).round(1) %><br>
                    <span id="original-rate"></span>
                    (<%= @reviews.count(:original_rate) %>)
                  </td>
                </tr>
              <% end %>
            </table>

            <div class="d-flex justify-content-around">
              <div class="icon-button">
                <i class="fas fa-shoe-prints ranking-show-shoe"></i><br>
                <%= @travel_count.count%>
              </div>
              <div class="icon-button">
                <i class="fa-solid fa-plane ranking-show-plane"></i><br>
                <%= @wish_count.count%>
              </div>

              <%= link_to memory_search_path(@country) do %>
                <div class="icon-button">
                  <i class="fa-solid fa-camera ranking-show-camera"></i><br>
                  <%= @memory_count.count%>
                </div>
              <% end %>

              <%= link_to hint_search_path(@country, {'type': 'country'}) do %>
                <div class="icon-button">
                  <i class="fa-solid fa-lightbulb ranking-show-light"></i><br>
                  <%= @hint_count.count%>
                </div>
              <% end %>
            </div><br>
          </div>
        </div>
      </div>


    <div class='col-md-7 mt-3'>
      <ul class="nav nav-tabs justify-content-between text-center">
        <li class="nav-item">
          <%= link_to 'Ê•Ω„Åó„Åï„ÉªÂ®ØÊ•Ω', review_path(@country, {'type': 'amusement'}), anchor: 'test', class:"nav-link" %>
        </li>
        <li class="nav-item">
          <%= link_to '„Ç∞„É´„É°', review_path(@country, {'type': 'gourmet'}), class:"nav-link" %>
        </li>
        <li class="nav-item">
          <%= link_to 'Ê≤ªÂÆâ', review_path(@country, {'type': 'security'}) , class:"nav-link"%>
        </li>
        <li class="nav-item">
          <%= link_to '„Åä„Åô„Åô„ÇÅ', review_path(@country, {'type': 'recommend'}), anchor: 'test', class:"nav-link" %>
        </li>
        <li class="nav-item">
          <%= link_to '„Ç™„É™„Ç∏„Éä„É´', review_path(@country, {'type': 'original'}), class:"nav-link" %>
        </li>
      </ul>

      <div class='list jscroll'>
        <% @reviews.each do |f| %>
          <table class='table'>
            <tr>
              <td>
                <div class="m-2 d-flex">
                  <div>

                    <%= link_to user_path(f.user_id) do %>
                      <%= image_tag f.user.get_user_image(55,55), class: "user-img" %>
                    <% end %>
                  </div>
                  <div>
                    <div>
                      <% country = Country.find_by(name_jp: f.user.country_code) %>
                      <i class="flag-icon flag-icon-<%= country.code.downcase %> user-icon"></i>
                      <%= f.user.user_name %>„Åï„Çì„ÅÆ„É¨„Éì„É•„Éº
                    </div>
                    <% if params[:type] == 'amusement' %>
                      <span id="amusement-rate<%= f.id %>"></span>
                      <%= f.amusement_rate %><br>
                      <%= f.amusement_voice %>
                    <% elsif params[:type] == 'gourmet' %>
                      <span id="gourmet-rate<%= f.id %>"></span>
                      <%= f.gourmet_rate %><br>
                      <%= f.gourmet_voice %>
                    <% elsif params[:type] == 'security' %>
                      <span id="security-rate<%= f.id %>"></span>
                      <%= f.security_rate %><br>
                      <%= f.security_voice %>
                    <% elsif params[:type] == 'recommend' %>
                      <span id="recommend-rate<%= f.id %>"></span>
                      <%= f.recommend_rate %><br>
                      <%= f.recommend_voice %>
                    <% elsif params[:type] == 'original' %>
                      <span class="ranking-original-category">„Äå<%= f.original_category %>„Äç</span><br>
                      <span id="original-rate<%= f.id %>"></span>
                      <%= f.original_rate %><br>
                      <%= f.original_voice %>
                    <% else %>
                      <span id="amusement-rate<%= f.id %>"></span>
                      <%= f.amusement_rate %><br>
                      <%= f.amusement_voice %>
                    <% end %>
                  </div>
                </div>
              </td>
            </tr>
          </table>
          <script>
            $('#amusement-rate<%= f.id %>').raty({
              starOff   : '<%= asset_path('star-off.1.png') %>',
              starOn    : '<%= asset_path('star-on.1.png') %>',
              starHalf : '<%= asset_path('star-half.1.png') %>',
              half      : true,
              readOnly: true,
              score: <%= f.amusement_rate %>
            });
            $('#gourmet-rate<%= f.id %>').raty({
              starOff   : '<%= asset_path('star-off.1.png') %>',
              starOn    : '<%= asset_path('star-on.1.png') %>',
              starHalf : '<%= asset_path('star-half.1.png') %>',
              half      : true,
              readOnly: true,
              score: <%= f.gourmet_rate %>
            });
            $('#security-rate<%= f.id %>').raty({
              starOff   : '<%= asset_path('star-off.1.png') %>',
              starOn    : '<%= asset_path('star-on.1.png') %>',
              starHalf : '<%= asset_path('star-half.1.png') %>',
              half      : true,
              readOnly: true,
              score: <%= f.security_rate %>
            });
            $('#recommend-rate<%= f.id %>').raty({
              starOff   : '<%= asset_path('star-off.1.png') %>',
              starOn    : '<%= asset_path('star-on.1.png') %>',
              starHalf : '<%= asset_path('star-half.1.png') %>',
              half      : true,
              readOnly: true,
              score: <%= f.recommend_rate %>
            });
            <% if f.original_rate.nil?  %>
    	      <% else %>
              $('#original-rate<%= f.id %>').raty({
                starOff   : '<%= asset_path('star-off.1.png') %>',
                starOn    : '<%= asset_path('star-on.1.png') %>',
                starHalf : '<%= asset_path('star-half.1.png') %>',
                half      : true,
                readOnly: true,
                score: <%= f.original_rate %>
              });
            <% end %>
          </script>
        <% end %>
      <%= paginate @reviews %>
      </div>
    </div>
  </div>
</div>

<script>
  $('#average-rate').raty({
  starOff   : '<%= asset_path('star-off.png') %>',
  starOn    : '<%= asset_path('star-on.png') %>',
  starHalf : '<%= asset_path('star-half.png') %>',
  half      : true,
  readOnly: true,
  score: <%= @reviews.average(:review_average) %>
  });

  $('#amusement-rate').raty({
    starOff   : '<%= asset_path('star-off.png') %>',
    starOn    : '<%= asset_path('star-on.png') %>',
    starHalf : '<%= asset_path('star-half.png') %>',
    half      : true,
    readOnly: true,
    score: <%= @reviews.average(:amusement_rate) %>
  });

  $('#gourmet-rate').raty({
    starOff   : '<%= asset_path('star-off.png') %>',
    starOn    : '<%= asset_path('star-on.png') %>',
    starHalf : '<%= asset_path('star-half.png') %>',
    half      : true,
    readOnly: true,
    score: <%= @reviews.average(:gourmet_rate) %>
  });

  $('#security-rate').raty({
    starOff   : '<%= asset_path('star-off.png') %>',
    starOn    : '<%= asset_path('star-on.png') %>',
    starHalf : '<%= asset_path('star-half.png') %>',
    half      : true,
    readOnly: true,
    score: <%= @reviews.average(:security_rate) %>
  });

  $('#recommend-rate').raty({
    starOff   : '<%= asset_path('star-off.png') %>',
    starOn    : '<%= asset_path('star-on.png') %>',
    starHalf : '<%= asset_path('star-half.png') %>',
    half      : true,
    readOnly: true,
    score: <%= @reviews.average(:recommend_rate) %>
  });

  <% if @reviews.average(:original_rate).nil? %>
    $('#original-rate0').raty({
      starOff   : '<%= asset_path('star-off.png') %>',
      starOn    : '<%= asset_path('star-on.png') %>',
      starHalf : '<%= asset_path('star-half.png') %>',
      half      : true,
      readOnly: true,
      score: 0
    });
  <% else %>
    $('#original-rate').raty({
      starOff   : '<%= asset_path('star-off.png') %>',
      starOn    : '<%= asset_path('star-on.png') %>',
      starHalf : '<%= asset_path('star-half.png') %>',
      half      : true,
      readOnly: true,
      score: <%= @reviews.average(:original_rate) %>
    });
  <% end %>

  $(function() {
    $('.jscroll').jscroll({
      contentSelector: '.list',
      nextSelector: 'span.next:last a'
    });
  });
</script>

<!--<script>-->
<!--  $(function() {-->
<!--    $('.jscroll').jscroll({-->
<!--      contentSelector: '.list',-->
<!--      nextSelector: 'span.next:last a'-->
<!--    });-->
<!--  });-->
<!--</script>-->

<% end %>